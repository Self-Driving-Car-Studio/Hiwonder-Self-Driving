## 🚗 Hiwonder 자율주행 로봇카 프로젝트
ROS2와 YOLOv5를 기반으로 Hiwonder 로봇카의 자율주행 시스템을 구현한 프로젝트입니다. 차선 유지, 실시간 객체 인식, 표지판 인식을 통한 미션 수행 등 다양한 자율주행 기능을 개발했습니다. 특히 Raspberry Pi 환경의 한계를 극복하기 위한 YOLO 성능 최적화 과정에 중점을 두었습니다.





## 🛠️ 주요 기술 스택 (Tech Stack)
Framework: ROS2, Python

AI/ML: YOLOv5

Hardware: Hiwonder Robot Car, Raspberry Pi





## 핵심 기능 (Features)
듀얼 ROI를 이용한 안정적인 차선 유지 주행

YOLOv5 성능 최적화를 통한 실시간 객체 인식 (횡단보도, 신호등, 표지판)

교차로 우회전, 횡단보도 정지, 지정 위치 주차 등 미션 수행

주행 상태에 따른 LED 점등 로직 (주행-초록, 정지-빨강, 우회전-주황)




## ⚙️ 주요 기능 구현 과정






## 1. 차선 유지 주행 (Lane Keeping)
안정적인 차선 유지를 위해 두 가지 ROI(Region of Interest, 관심 영역) 모드를 동적으로 변경하는 방식을 적용했습니다.

Look-ahead 모드: 직선 주행 시, 멀리 있는 차선을 인식하여 차량을 차선 중앙에 안정적으로 위치시킵니다. 기존 ROI 방식은 차량이 중앙에 위치할 경우 좌/우 차선을 놓치는 문제가 있었지만, 이 모드를 통해 해결했습니다.

Close-up 모드: 코너링 시야각이 좁아져 멀리 있는 차선 인식이 어려울 때, 가까운 영역을 집중적으로 인식하여 안정적인 코너링을 수행합니다.

## 2. 실시간 객체 인식을 위한 성능 최적화
Raspberry Pi에서 YOLOv5를 실행했을 때 2초 이상의 심각한 딜레이가 발생하여 실시간 주행이 불가능했습니다. 이 문제를 해결하기 위해 다음과 같은 4가지 최적화 기법을 적용하고 성능을 극적으로 개선했습니다.

### 1) 프레임 스키핑 (Frame Skipping)
문제점: 모든 프레임에서 YOLO 객체 인식을 실행하면 CPU에 과부하가 걸려 심한 딜레이가 발생합니다. 아래는 프레임 스키핑 적용 전의 모습입니다.

해결책: 5프레임마다 한 번씩만 객체 인식을 수행하여 CPU 사용량을 줄이고, 인식의 연속성과 실시간성 사이의 균형을 맞췄습니다.

![nonframeskip demo](./gif_image/nonframeskip.gif)

### 2) Warmup
문제점: YOLO 모델이 처음 실행될 때 초기화 과정으로 인해 첫 객체 인식에 큰 딜레이가 발생합니다. Warmup을 적용하기 전에는 아래와 같이 첫 인식 반응이 매우 느렸습니다.

해결책: 메인 로직 실행 전, 더미(dummy) 데이터를 입력하여 모델을 미리 한번 실행시켜 줍니다. 이를 통해 실제 주행 시 첫 프레임부터 딜레이 없는 객체 인식이 가능해졌습니다.

![nonwarmup demo](./gif_image/nonwarmup.gif)

### 3) ONNX 모델 변환
문제점: PyTorch의 .pt 모델은 무거워 Raspberry Pi 같은 경량 디바이스에서 사용하기에 적합하지 않습니다.

해결책: 모델을 경량화된 ONNX(Open Neural Network Exchange) 형식으로 변환하여 추론 속도를 크게 향상시켰습니다. 아래는 ONNX 모델 적용 후 객체를 빠르고 부드럽게 인식하는 모습입니다.

![onnx demo](./gif_image/onnx.gif)

### 4) 오버클럭 (Overclocking)
문제점: Raspberry Pi의 기본 클럭 속도로는 YOLO 연산을 처리하기에 부족했습니다. 아래는 오버클럭 적용 전의 모습입니다.

해결책: 하드웨어의 처리 속도를 직접 높이는 오버클럭을 통해 연산 성능을 물리적으로 향상시켜 전체적인 딜레이를 줄였습니다.

![nonoverclock demo](./gif_image/nonoverclock.gif)

## 3. 미션 수행 및 LED 제어
횡단보도 및 신호등: 최적화된 YOLO 모델을 통해 횡단보도와 신호등을 실시간으로 인식하고, 요구사항에 맞춰 정확히 1초간 정지 후 주행합니다.

표지판 인식: right 표지판 인식 후 교차로에서 우회전하고, park 표지판을 인식하면 지정된 위치로 이동하여 주차(park_action)를 수행합니다.

LED 상태 표시:

주행 중: Green LED ON

정지 중: Red LED ON

우회전 중: Right LED 깜빡임
